// GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN
buildscript {
	repositories {
		jcenter()
	}

	dependencies {
		classpath 'com.android.tools.build:gradle:2.3.3'
	}
}

allprojects {
	repositories {
		flatDir {
			dirs 'libs'
		}
	}
}
apply plugin: 'com.android.application'

//add+导入until
apply from:  "../../tools/android/utils.gradle"
//add

dependencies {
    compile fileTree(include: ['*.jar'], dir: 'libs')
    compile project(path: ':proj.and')
    compile project(path: ':proj.andCommonSdk')
}

android {
    compileSdkVersion 21
    buildToolsVersion '25.0.2'

    //add+自动提升版本号
    def currentVersionCode = modifyVersion(rootDir.absolutePath)
    //add
    defaultConfig {
        targetSdkVersion 21

        //add+ 版本号配置
        versionCode currentVersionCode.versionCode
        versionName currentVersionCode.versionName
        //add

    }
    lintOptions {
        abortOnError false
        checkReleaseBuilds false
    }


    aaptOptions {
        noCompress "lua", "wem", "ast", "bnk"
    }
    //add+签名配置
    signingConfigs {
        debug {

        }
        //配置签名的关键信息
        release {
            storeFile
            storePassword
            keyAlias
            keyPassword
        }
    }
    //add


    buildTypes {
        debug {
            jniDebuggable true
            manifestPlaceholders = [CHANNELID : "and_xianyu",
                                    ICON :"@drawable/app_icon3",
                                    REYUN_KEY :"cdd573b65fc8d8806ca79750d5c6f991"
            ]
        }
        release {
            minifyEnabled false
            zipAlignEnabled true
            signingConfig signingConfigs.release
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-unity.txt'

        }
    }
    //add+ 多渠道打包配置 无需求删除 manifestPlaceholders 替换manifest中的相应${xxxx}
    productFlavors {
        taptap {
            applicationId "com.xianyugame.zydxc.taptap"
            manifestPlaceholders = [CHANNELID: "and_taptap_xianyu",
                                    ICON     : "@drawable/app_icon2",
                                    REYUN_KEY :""
            ]
        }
        xianyu {
            applicationId "com.xianyugame.zydxc"
            manifestPlaceholders = [CHANNELID: "and_xianyu",
                                    ICON     : "@drawable/app_icon3",
                                    REYUN_KEY :"cdd573b65fc8d8806ca79750d5c6f991"
            ]
        }
    }
    //add


    //add+ 打包修改输出文件名
    applicationVariants.all { variant ->
        generate(variant, defaultConfig)
    }
    //add
}

//add+ 使用配置签名
getSign(android)
//add